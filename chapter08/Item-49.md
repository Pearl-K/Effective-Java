# Item 49. 매개변수가 유효한지 검사하라
메서드와 생성자 대부분은 입력 매개변수 값이 특정 조건을 만족해야 안전하다. 


특히, 메서드 몸체가 실행되기 전에 매개변수를 확인하여 잘못된 값이 넘어왔을 때, 메서드를 실행하지 않고 깔끔하게 예외를 던져 처리할 수 있다.


## 매개변수 검사를 제대로 하지 않을 때 문제점
1. 메서드가 수행되는 중간에 모호한 예외를 던질 수 있다.
2. 메서드가 수행됐으나 잘못된 결과를 반환한다.
3. 메서드가 문제없이 수행됐으나, 객체를 이상한 상태로 반환하여 미래에 알 수 없는 시점에 관련 없는 오류를 낼 수 있다.


따라서 매개변수 검사를 하는 것이 필요하고, public과 protected 메서드는 매개변수 값이 잘못됐을 때 던지는 예외를 문서화해야 한다.


## 매개변수 검사 문서화하기
- 제약을 문서화 할 때, 해당 조건을 어겼을 때 발생하는 예외도 함께 문서화하여 API 사용자가 제약을 지킬 가능성을 높이자.
- 클래스 수준 주석을 사용하여 설명을 기입할 수 있다.
- 또한, Java7+ 부터 `java.util.Object.requireNonNull` 메서드를 사용할 수 있다.
    - 원하는 곳에서 순수한 `null` 검사 목적으로 사용
- Java9+ 에서는 Objects에 범위 검사 기능도 추가되었다.
    - `checkFromIndexSize`, `checkFromToIndex`, `checkIndex`
    - But, 이 메서드들은 null 검사 메서드만큼 유연하지 않다. (예외 메시지 지정 불가, 리스트 & 배열 전용)


### 개발한 메서드의 매개변수 유효성 검증
- 공개되지 않은 메서드라면, 패키지 제작자가 그 메서드가 호출되는 상황을 통제해야한다.
- `public` 이 아닌 메서드라면, assert 를 사용하여 매개변수 유효성을 검증할 수 있다.


```java
private static void sort(long a[]. int offset, int legth) {
    assert a != null;
    assert offset >= 0 && offset <= a.length;
    assert length >= 0 && length <= a.length - offset;

    // 나머지 계산 수행..
}
```


이 코드에서, assert 문들은 자신이 단언한 조건이 무조건 참이라고 선언한다. 그러나 assert 문은 일반적인 유효성 검사와 다르다.


1. 실패하면 `AssertionError` 를 던진다.
2. 런타임에 아무런 효과도, 성능 저하도 없다.


마지막으로, 메서드가 직접 사용하지는 않으나 나중에 사용하기 위해 저장하는 매개변수를 특히 더 신경써서 검사해야 한다. 
- 여기서 검증하지 못하면, 나중에 검증되지 않은 값을 사용할 때 문제가 발생한다.
- 어디서 오류가 났는지 디버깅 포인트를 잡기 어려워진다.


## 한계
- 이 아이템의 내용은 매개변수 제약을 계속 추가하는 것이 좋다는 의미가 아니다.
- 매개변수 제약은 없을수록 좋다. (최대한 범용적으로 메서드 설계)
- 그러나, 제약이 없을 때 문제가 발생할 수 있으므로 그 가능성을 막기 위해 도입된 것이다. (추후 위험을 막기 위해 현재 필요한 경우)


---
## Summary
- 메서드나 생성자를 작성할 때 해당 매개변수들에 어떤 제약이 필요한지 생각해야 한다.
- 그 제약들을 문서화하고 메서드 코드 시작 부분에서 명시적으로 검사해야 한다.
